(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54858,e=>{"use strict";let t="http://localhost:8081/api";function r(e){if("undefined"==typeof document)return null;console.log("当前所有cookie:",document.cookie);let t=e+"=",r=document.cookie.split(";");for(let a=0;a<r.length;a++){let s=r[a];for(;" "===s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(t)){let r=decodeURIComponent(s.substring(t.length,s.length));return console.log(`找到cookie ${e}:`,r),r}}return console.log(`未找到cookie ${e}`),null}let a=async(e,a,s,o,n)=>{let i=new URLSearchParams;i.append("page",e.toString()),i.append("size",a.toString()),s&&"all"!==s&&i.append("status",s),o&&i.append("keyword",o),n&&"all"!==n&&i.append("role",n);try{let e=r("Authorization"),a={"Content-Type":"application/json"};e&&(a.Authorization=e);let s=await fetch(`${t}/admin/users?${i}`,{method:"GET",headers:a,credentials:"include"});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);return s.json()}catch(t){return console.error("获取用户列表失败:",t),{code:500,message:"网络错误或服务器无响应",data:{currentPage:e,pageSize:a,total:0,totalPages:0,records:[],hasPrevious:!1,hasNext:!1},timestamp:Date.now()}}},s=async(e,a)=>{try{let s=r("Authorization"),o={"Content-Type":"application/json"};s&&(o.Authorization=s);let n=await fetch(`${t}/admin/users/${e}/status`,{method:"PUT",headers:o,credentials:"include",body:JSON.stringify({status:a})});if(!n.ok)throw Error(`HTTP error! status: ${n.status}`);return n.json()}catch(e){return console.error("更新用户状态失败:",e),{code:500,message:"网络错误或服务器无响应",data:null,timestamp:Date.now()}}},o=async(e,a,s)=>{let o=new URLSearchParams({page:e.toString(),size:a.toString()});s&&o.append("keyword",s);try{let e=r("Authorization"),a={"Content-Type":"application/json"};e&&(a.Authorization=e);let s=await fetch(`${t}/admin/posts/pending?${o}`,{method:"GET",headers:a,credentials:"include"});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);return s.json()}catch(t){return console.error("获取帖子列表失败:",t),{code:500,message:"网络错误或服务器无响应",data:{currentPage:e,pageSize:a,total:0,totalPages:0,records:[],hasPrevious:!1,hasNext:!1},timestamp:Date.now()}}},n=async(e,a,s)=>{let o=new URLSearchParams({page:e.toString(),size:a.toString()});s&&o.append("keyword",s);try{let e=r("Authorization"),a={"Content-Type":"application/json"};e&&(a.Authorization=e);let s=await fetch(`${t}/admin/posts/pending?${o}`,{method:"GET",headers:a,credentials:"include"});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);return s.json()}catch(t){return console.error("获取帖子列表失败:",t),{code:500,message:"网络错误或服务器无响应",data:{currentPage:e,pageSize:a,total:0,totalPages:0,records:[],hasPrevious:!1,hasNext:!1},timestamp:Date.now()}}},i=async(e,a)=>{try{let s=r("Authorization"),o={"Content-Type":"application/json"};s&&(o.Authorization=s);let n=await fetch(`${t}/admin/posts/${e}/top`,{method:"PUT",headers:o,credentials:"include",body:JSON.stringify({isTop:a})});if(!n.ok)throw Error(`HTTP error! status: ${n.status}`);return n.json()}catch(e){return console.error("更新帖子置顶状态失败:",e),{code:500,message:"网络错误或服务器无响应",data:null,timestamp:Date.now()}}},l=async(e,a)=>{try{let s=r("Authorization"),o={"Content-Type":"application/json"};s&&(o.Authorization=s);let n=await fetch(`${t}/admin/posts/${e}/featured`,{method:"PUT",headers:o,credentials:"include",body:JSON.stringify({isFeatured:a})});if(!n.ok)throw Error(`HTTP error! status: ${n.status}`);return n.json()}catch(e){return console.error("更新帖子精华状态失败:",e),{code:500,message:"网络错误或服务器无响应",data:null,timestamp:Date.now()}}},c=async(e,a,s,o)=>{try{let n=r("Authorization"),i={"Content-Type":"application/json"};n&&(i.Authorization=n);let l=await fetch(`${t}/admin/posts/${e}/moderate`,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify({decision:a,riskLevel:s,reason:o})});if(!l.ok)throw Error(`HTTP error! status: ${l.status}`);return l.json()}catch(e){return console.error("审核帖子失败:",e),{code:500,message:"网络错误或服务器无响应",data:null,timestamp:Date.now()}}},d=async e=>{try{let a=r("Authorization"),s={"Content-Type":"application/json"};a&&(s.Authorization=a);let o=await fetch(`${t}/admin/posts/${e}`,{method:"DELETE",headers:s,credentials:"include"});if(!o.ok)throw Error(`HTTP error! status: ${o.status}`);return o.json()}catch(e){return console.error("删除帖子失败:",e),{code:500,message:"网络错误或服务器无响应",data:null,timestamp:Date.now()}}},u=async()=>{try{let e=r("Authorization"),a={"Content-Type":"application/json"};e&&(a.Authorization=e);let s=await fetch(`${t}/public/categories`,{method:"GET",headers:a,credentials:"include"});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);return s.json()}catch(e){return console.error("获取分类列表失败:",e),{code:500,message:"网络错误或服务器无响应",data:[],timestamp:Date.now()}}},h=async e=>{try{let r=await fetch(`${t}/public/login`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e),redirect:"follow"});if(!r.ok)throw Error(`HTTP error! status: ${r.status}`);let a=await r.json();return console.log("登录接口响应数据:",a),a}catch(e){return console.error("登录失败:",e),{code:500,message:"网络错误或服务器无响应",data:{accessToken:"",user:{userId:0,studentId:"",role:"",status:0}},timestamp:Date.now()}}};e.s(["deletePost",0,d,"fetchAllPosts",0,n,"fetchCategories",0,u,"fetchPosts",0,o,"fetchUsers",0,a,"login",0,h,"moderatePost",0,c,"togglePostFeaturedStatus",0,l,"togglePostTopStatus",0,i,"updateUserStatus",0,s])},70065,e=>{"use strict";var t=e.i(43476),r=e.i(47163);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...a})}function s({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...a})}function o({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",e),...a})}function n({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...a})}function i({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",e),...a})}function l({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,r.cn)("flex items-center px-6 [.border-t]:pt-6",e),...a})}e.s(["Card",()=>a,"CardContent",()=>i,"CardDescription",()=>n,"CardFooter",()=>l,"CardHeader",()=>s,"CardTitle",()=>o])},89954,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(18566),s=e.i(67881),o=e.i(23750),n=e.i(10708),i=e.i(70065),l=e.i(81947),c=e.i(75254);let d=(0,c.default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),u=(0,c.default)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var h=e.i(84614),m=e.i(54858);function p(){let e=(0,a.useRouter)(),c=(0,a.useSearchParams)(),[p,g]=(0,r.useState)(""),[x,f]=(0,r.useState)(""),[y,w]=(0,r.useState)(""),[j,T]=(0,r.useState)(!1),N=c.get("redirect")||"/post-management",P=async t=>{if(t.preventDefault(),t.stopPropagation(),!j){T(!0),w("");try{let t=await (0,m.login)({studentId:p,password:x,role:"admin"});if(console.log("登录响应:",t),200===t.code)if(t.data.accessToken){var r;let a,s,o;r=t.data.accessToken,a="",(s=new Date).setTime(s.getTime()+6048e5),a="; expires="+s.toUTCString(),o="Authorization="+(r||"")+a+"; path=/; SameSite=Lax;","https:"===window.location.protocol&&(o+=" Secure;"),document.cookie=o;{let e={userId:t.data.user.userId,studentId:t.data.user.studentId,role:t.data.user.role,status:t.data.user.status};window.localStorage.setItem("userInfo",JSON.stringify(e))}await new Promise(e=>setTimeout(e,100)),console.log("登录成功，即将跳转到:",N),e.push(N)}else console.error("登录响应中缺少Authorization字段:",t),w("登录响应异常，请稍后再试");else w(t.message||"登录失败")}catch(e){w("登录失败，请稍后再试"),console.error("登录错误:",e)}finally{T(!1)}}};return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4 py-12 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto h-16 w-16 rounded-full bg-primary-blue flex items-center justify-center",children:(0,t.jsx)(u,{className:"h-8 w-8 text-white"})}),(0,t.jsx)("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"AetherNet 管理系统"}),(0,t.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"请输入您的账号信息登录"})]}),(0,t.jsxs)(i.Card,{className:"shadow-lg",children:[(0,t.jsxs)(i.CardHeader,{className:"space-y-1",children:[(0,t.jsx)(i.CardTitle,{className:"text-2xl font-bold text-center",children:"登录"}),(0,t.jsx)(i.CardDescription,{className:"text-center",children:"请输入您的学号和密码"})]}),(0,t.jsxs)(i.CardContent,{children:[y&&(0,t.jsxs)(l.Alert,{variant:"destructive",className:"mb-4",children:[(0,t.jsx)(d,{className:"h-4 w-4"}),(0,t.jsx)(l.AlertDescription,{children:y})]}),(0,t.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"studentId",children:"学号"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(h.User,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,t.jsx)(o.Input,{id:"studentId",type:"text",placeholder:"请输入学号",value:p,onChange:e=>g(e.target.value),className:"pl-10",required:!0})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"password",children:"密码"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(u,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,t.jsx)(o.Input,{id:"password",type:"password",placeholder:"",value:x,onChange:e=>f(e.target.value),className:"pl-10",required:!0})]})]}),(0,t.jsx)(s.Button,{type:"submit",className:"w-full",disabled:j,children:j?(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"登录中..."]}):"登录"})]})]}),(0,t.jsx)(i.CardFooter,{className:"flex flex-col",children:(0,t.jsxs)("div",{className:"text-sm text-gray-500 text-center",children:[(0,t.jsx)("p",{children:"默认账号: admin"}),(0,t.jsx)("p",{children:"默认密码: password"})]})})]})]})})}e.s(["default",()=>p],89954)}]);